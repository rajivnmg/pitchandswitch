import React, { Component } from 'react';
import { memoize, identity, once } from 'ramda';
import { connect } from 'react-redux';
import { BrowserRouter, Route } from 'react-router-dom'
import ShadowDOM from '../../../src/react-shadow';
import Country from '../components/country';

/**
 * @method toSlug
 * @param {String} x
 * @return {String}
 */
export const toSlug = memoize(x => x.replace(/ /g, '-'));

/**
 * @method fromSlug
 * @param {String} x
 * @return {String}
 */
export const fromSlug = memoize(x => x.replace(/-/g, ' '));

/**
 * @method filenameFor
 * @param {String} x
 * @return {String}
 */
export const filenameFor = memoize(x => `/images/${toSlug(x).toLowerCase()}.png`);

/**
 * @method randomFrom
 * @param {Array} xs
 * @return {String}
 */
const randomFrom = once(xs => xs[Math.floor(Math.random() * xs.length)]);

/**
 * @param {Object} props
 * @return {XML}
 */
export default connect(identity)(class extends Component {

    state = { x: true };

    render() {

        return (
            <BrowserRouter>
                <ShadowDOM include="css/country.css">
                        <section className="weather">
                            <Route exact path="/" render={() => <Country {...this.props} country={randomFrom(props.countries)} />} />
                            <Route exact path="/:country.html" render={({ match }) => <Country {...this.props} country={this.props.match.params.country} />} />
                        </section>
                        </ShadowDOM>
                    ]}
            </BrowserRouter>
        );
        
    }

});
